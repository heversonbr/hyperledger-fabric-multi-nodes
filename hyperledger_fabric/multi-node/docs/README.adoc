= Deploy and use Hyperledger Fabric on multiple nodes - a simple path.


== Introdution

In this document we show how to proceed to deploy a simple Blockchain
infrastructure composed of multiple nodes.
The goal of this study is: _i_) better understand the deployment of Hyperledger
Fabric in realistic environments (i.e., composed of multiple machines).
_ii_) make a step forward from the environment targeted by the official Hyperledger
documentation which is based only on a single node with multiple containers.
We argue that this approch hides many important details of process of deploying
and using the Hyperledger framework.
We propose here a procedure and a series of step-by-step scripts that make it easy
to deploy and use Hyperledger Fabric

== Target environment

In this document we target a simple environment composed of 2 different
organizations. One organization in charge of orderer nodes and another organization
hosting peers and the MSP root service (e.i., the CA-Root).
The former is composed of 4 (four) hosts (ca-server, organization's ca-admin,
peer1 and peer2) and the latter composed of 2 hosts (ca-admin and orderer node).
Note that, we use in this example a single node as ordering service in order to
make it easier. In a subsequent document we will improve it with a multi-node
ordering service.

:TODO: put a figure here to represent the environment


== Download scripts

We have created a series of scripts to make the whole process of deploying and using
the Hyperledger Blockchain easier. Our goal is not only facilitate the process of
deploying Hyperledger but also to make it easier to understand every step of the
full process.

To download the scripts follow the *_link_* [[link]].

:TODO: make a link or something to download the scripts.

Download the files within a directory of your choice,
lets call this directory your 'base_local_dir'.
Your 'base_local_dir' will have the following structure.

```
.
├── shared
│   ├── chaincode_examples
│   │   └── example1
│   │       ├── scripts
│   │       └── src
│   ├── config_files
│   ├── install
│   └── setup_scripts
└── src_vagrant
│
└── Vagrantfile
```

The `shared` directory is the directory shared between your local machine and
the hosts (virtual machines) to be used as hyperledger nodes.
We discuss this directory in details later <<shared_vagrant_dir,here>>.
The `src_vagrant` directory has the sources for our vagrant deployment.
Currently, it has two different versions of the `Vagrantfile`, one for Openstack
and another for Virtualbox deployments. We must copy the content of one of this
files into the `Vagrantfile` at the root of you 'base_local_dir', according to the
deployment of your choice. By default we use Openstack deployment.


== How to use the scripts to deploy Hyperledger

If you have successfully downloaded the scripts as described above now you are
able to start using them. Lets start by briefly describing how we use vagrant
to deploy Hyperledger hosts.

[[conf-overview]]
=== Host configuration

We use https://www.vagrantup.com/[vagrant] to deploy the virtual machines at same
time with a specific configuration. If you do not have vagrant installed in your
local machine yet, please take the time to do that now.
The vagrant file (`Vagrantfile`) is where these configurations are stored.
We use the openstack plugin (https://github.com/ggiamarchi/vagrant-openstack-provider)
to deploy these machines in our Openstack cluster.

In the `Vagrantfile`, each host is defined as an entry in a data structure
called *_cluster_*. Each entry (host) in *_cluster_* has the following structure.

[source, ruby]
----
{
    :name => "msp-root-org1",
    :username => "ubuntu",
    :type => "ca-server",
    :box => "ubuntu1604_img",
    :flavor => "j1.medium",
    :netid => "d085327f-2cea-4e14-8784-764ee72b92f4",
    :netadd => "192.168.1.10",
    :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
}
----
With `name` informing the hostname to be deployed, `username` the default user to
be created in that host, `type` the type of node according to the Hyperledger
architecture (e.g., peer, orderer, msp-admin, msp-root, etc.)
If you want to take a look in the full `Vagrantfile` and the detailed configuration
of all the hosts, check the  <<appendix:vagrantfile, Appendix>>.

=== Deploy all nodes (VMs)

Use the e *vagrant up* command in order to deploy our machines.
Note that, this operation takes few minutes, depending on the number of hosts to
deploy. Thus, execute the command as show below and go for a coffee.

[source, bash]
----
$ vagrant up
----

When the deployment finishes, you can check the status of each deployed virtual machine.

[source, bash]
----
$ vagrant status
Current machine states:
name                      state    provider
--------------------------------------------
msp-root-org1             active (openstack)
msp-admin-org1            active (openstack)
msp-admin-orderer         active (openstack)
orderer-node              active (openstack)
peer1-org1                active (openstack)
peer2-org1                active (openstack)
----

In order to check the deployment connect to one of the hosts (e.g., msp-root-org1)
from your local machine using any terminal.

[source, bash]
----
$ vagrant ssh msp-root-org1
----

[[shared_vagrant_dir]]
Vagrant creates the hosts defined in the `Vagrantfile` and sets a ssh configuration
`~/.ssh/config` at each node with entries to all the other nodes
as well as `/etc/hosts` and `/etc/resolv.conf` files.
These files are dynamically created during the vagrant deployment thanks to some
ruby code that we have previously added to it.
Vagrant also creates a directory called `~/hyperledger_ws`
(i.e., hyperledger workspace) at the home directory of each host, which we refer
to as HYPERLEDGER_HOME directory.
The directory has the following structure and content.

[source, bash]
----
$ cd hyperledger_ws/

~/hyperledger_ws$ tree -dL  1
.
├── install
├── setup_scripts
├── config_files
└── chaincode_example
----

- *install*: directory that contains the scripts used to install Hyperledger Fabric
software in the hosts and create the base configuration for each.

- *setup_scripts*: directory that contains the scripts used to set up Hyperledger
environment and its configuration.

- *config_files*: directory that contains template files used to configure Hyperledger
environment.

- *chaincode_examples*: directory that contains the chaincode example used to validate
the installation and configuration.

After checking these directories, logout (exit) back to your local host.

=== Installing Hyperledger Fabric software

In order to ease the installation process we provide two different terminal
layouts that will be used during the installation and configuration processes.
The first layout configuration file (`terminator_config`) must be used with the
terminal emulator called _terminator_ that must be installed in your local host,
and the second (windows.tmux.hlf) will be used with _byobu_ from a ssh connection
between your local host and one of the virtual machines created by vagrant.
In order to install the Fabric software on the hosts we will use the first
terminal layout based on terminator.

====== Using Terminator layouts

We use the `terminator` to perform some repetitive tasks that are required to
install Hyperledger fabric on all hosts.
The reason is that `terminator` has a very good broadcast feature.
Therefore, to install all the required software at once on hosts we provide
a layout configuration file called `./install/terminator_config` which allows to
run scripts in one terminal screen connected to one machine and broadcast this
commands to the others. Note that, there are other more advanced ways of doing that,
for instance by using https://www.ansible.com[ansible] tool. We have chosen at this
point not to use ansible in order to avoid a stack of configuration tools that would
hide important details of the configuration. We recall that on of our goals is to
make it clear to the reader the configuration and utilization of Hyperledger
Fabric.

First, install `terminator` into your local machine, if you do not have it.
If you already have `terminator` installed please skip this step.
[source, bash]
----
$ sudo apt-get install terminator
----

Then, copy our configuration file to `~/.config/terminator/config` in your home
directory.

[source, bash]
----
$ cp .shared/install/terminator_config  ~/.config/terminator/config
----

Finally invoke the terminator layout to install Hyperledger Fabric as follows:

[source, bash]
----
$ terminator -l simple_hlf
----

As as result terminator  will open a terminal with a specific layout using multiple
tabs.
If everything goes well each tab will be connected through ssh to one of the
Hyperledger hosts deployed by vagrant, as shown below.

image::img/terminator.png[]

NOTE: Please, be sure that any command (e.g., ls) executed in the first tab (msp-root-org1)
is broadcast to all the other hosts.
If not, check if the option `Broadcast default` is set to `Group` in `terminator`
preferences. If everything goes well with the broadcast, go to the next section.



==== Installing Fabric

In this section we show how to get all the required software installed at all the
hosts at once by using the `terminator` layout shown in the previous section.
Our procedure presents the all the steps required to install Hyperledger Fabric
using our installation scripts.

Go to the first tab (i.e., host msp-root-org1) in your `terminator` environment
and take a look on the installation scripts.

[source, bash]
----
$ cd hyperledger_ws/install
$ ls
    01_install_docker.sh
    02_install_prereqs.sh
    03_install_bootstrap.sh
    04_install_ca_server.sh
    05_setup_go_libs_for_peers_chaincodes.sh
    broadcast_cmd.sh
    check_prereqs.sh
    fabric.env.sh
    setup_byobu.sh
    terminator_config
    windows.tmux.hlf
----

Note that, the scripts are named according to the order of execution (from 01_*.sh
to 05_*.sh) and their function in the installation process (e.g., install_docker, install_ca_sever).

Please, run the scripts one-by-one from the 'install' directory at each node as
follows.


===== Install docker

In order to install docker run the script as follows.

[[docker_install]]
[source, bash]
----
$ ./01_install_docker.sh
----

You can also check a full log of docker installation in the section
<<appendix:installdocker, Appendix B: Installation logs>>.

When finished, logout from all hosts and reconnect again with the same `terminator`
layout again. Then check the installation as shown below.


[source, bash]
----
$ docker ps
CONTAINER ID    IMAGE   COMMAND    CREATED   STATUS    PORTS   NAMES

$ docker --version
Docker version 19.03.3, build a872fc2

$ docker info
----

===== Install fabric requirements

In order to install Hyperledger Fabric requirements run the script as follows.

[[req_install]]
[source, bash]
----
$ ./02_install_prereqs.sh
----

You can check a full log of fabric requirements installation in the section
<<appendix:req_install, Appendix B: Installation logs>>.

When finished, logout from all hosts and reconnect again with the same `terminator`
layout again. Note that, when logging back you will be (from now on) redirected
automatically to the $HYPERLEDGER_HOME directory (i.e., ~/hyperledger_ws).

You can now check if all the base requirements were install by using the script
shown below.

[[req_check]]
[source, bash]
----
$~/hyperledger_ws/install$ ./check_prereqs.sh

----


NOTE: Be sure that all requirements are correctly installed on each host.

You can check the output log of the check in the section
<<appendix:req_check, Appendix B: Installation logs>>.

===== Install bootstrap binaries and images

In order to install the binaries and required images please run the script as follows.

[[bootstrap_install]]
[source, bash]
----
$ ./03_install_bootstrap.sh
----

You can check a full log of binaries and images installation in the section
<<appendix:fabric-bootstrap, Appendix B: Installation logs>>.


===== install Go libraries for peer and chaincode

Run the script as shown below in order to install the GO libraries for peers and
chaincode.

[[go_lib_install]]
[source, bash]
----
$ ./04_setup_go_libs_for_peers_chaincodes.sh
----
Check a full log of Go libraries installation in the section
<<appendix:fabric-go-lib, Appendix B: Installation logs>>.

When finished, logout from all hosts.


===== Install CA-Root host

Finally the last step of the installation is to install the certification authority
root server at the host which is in charge of this service.
In our case, the host `msp-root-org1`.
Thus, connect through ssh on this host using the command `*vagrant ssh msp-root-org1*` from
your local machine and run the following script.
After connected, run the script shown below from the `install` directory.

[[ca_root_install]]
[source, bash]
----
$ ./05_install_ca_server.sh
----

Check a full log of the CA-server installation in the section
<<appendix:fabric-ca-root, Appendix B: Installation logs>>.


NOTE: If all the previous steps went well, now you are ready to start configuring your
Hyperledger Fabric as we will discuss in the next section.








=== Setting up Hyperledger configuration



=== Using Hyperledger Fabric to deploy smart-contracts


















== break here




== Using the scripts



==== Setting Certification authority

The first step is to set up the certification authority infrastructure.

Nodes of type *msp* are the hosts in charge of the cerfification authority (CA).
 Among them, there is a host named *ca-admin* which is the CA administrator.
 The others are named according to the organization they belong to. For instance,
 the host *org1-msp-1* is the host *msp-1* from organization *org1*.

===== CA adminstration host (ca-admin)


.1. log (ssh) into CA administrator host called *ca-admin*


[source, bash]
----
$ vagrant ssh ca-admin

$ cd setup_scripts/
----


.2. Start the CA server.

run *$HYPERLEDGER_HOME/setup_scripts/start_ca_server.sh* to start the CA server.


[source, bash]
----

$ ./start_ca_server.sh

checking /home/ubuntu/hyperledger_ws/ca-server/fabric-ca-server-config.yaml
Server YAML not found in /home/ubuntu/hyperledger_ws/ca-server/
Copying /home/ubuntu/hyperledger_ws/config_files/fabric-ca-server-config.yaml to /home/ubuntu/hyperledger_ws/ca-server
Starting server with: /home/ubuntu/hyperledger_ws/ca-server/fabric-ca-server-config.yaml
./Server Started ... Logs available at /home/ubuntu/hyperledger_ws/ca-server/ca-server.log
---------------------------- /home/ubuntu/hyperledger_ws/ca-server/ca-server.log -----------------------------------
2019/09/02 14:55:22 [INFO] Configuration file location: /home/ubuntu/hyperledger_ws/ca-server/fabric-ca-server-config.yaml
2019/09/02 14:55:22 [INFO] Starting server in home directory: /home/ubuntu/hyperledger_ws/ca-server
2019/09/02 14:55:22 [WARNING] Unknown provider type: ; metrics disabled
2019/09/02 14:55:22 [INFO] Server Version: 1.4.4
2019/09/02 14:55:22 [INFO] Server Levels: &{Identity:2 Affiliation:1 Certificate:1 Credential:1 RAInfo:1 Nonce:1}
2019/09/02 14:55:22 [WARNING] &{69 The specified CA certificate file /home/ubuntu/hyperledger_ws/ca-server/ca-cert.pem does not exist}
2019/09/02 14:55:22 [INFO] generating key: &{A:ecdsa S:256}
2019/09/02 14:55:23 [INFO] encoded CSR
2019/09/02 14:55:23 [INFO] signed certificate with serial number 56730824853204648070401816351616673671938225174
2019/09/02 14:55:23 [INFO] The CA key and certificate were generated for CA acme-ca
2019/09/02 14:55:23 [INFO] The key was stored by BCCSP provider 'SW'
2019/09/02 14:55:23 [INFO] The certificate is at: /home/ubuntu/hyperledger_ws/ca-server/ca-cert.pem
2019/09/02 14:55:24 [INFO] Initialized sqlite3 database at /home/ubuntu/hyperledger_ws/ca-server/fabric-ca-server.db
2019/09/02 14:55:24 [INFO] The issuer key was successfully stored. The public key is at: /home/ubuntu/hyperledger_ws/ca-server/IssuerPublicKey, secret key is at: /home/ubuntu/hyperledger_ws/ca-server/msp/keystore/IssuerSecretKey
2019/09/02 14:55:24 [INFO] Idemix issuer revocation public and secret keys were generated for CA 'acme-ca'
2019/09/02 14:55:24 [INFO] The revocation key was successfully stored. The public key is at: /home/ubuntu/hyperledger_ws/ca-server/IssuerRevocationPublicKey, private key is at: /home/ubuntu/hyperledger_ws/ca-server/msp/keystore/IssuerRevocationPrivateKey
2019/09/02 14:55:24 [INFO] Home directory for default CA: /home/ubuntu/hyperledger_ws/ca-server
2019/09/02 14:55:24 [INFO] Operation Server Listening on [::]:40922
2019/09/02 14:55:24 [INFO] Listening on http://192.168.1.10:7054
----


.3. Enroll the bootstrap identity of our CA server (the admin client)

[source, bash]
----
$ ./enroll_bootstrap_identity.sh

current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/caserver/admin
Client YAML not found in /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/
mkdir -p /home/ubuntu/hyperledger_ws/ca-client/caserver/admin
Copying the /home/ubuntu/hyperledger_ws/config_files/fabric-ca-client-config.yaml to /home/ubuntu/hyperledger_ws/ca-client/caserver/admin
Enrolling ca-client with: /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/fabric-ca-client-config.yaml
2019/09/02 14:55:28 [INFO] generating key: &{A:ecdsa S:256}
2019/09/02 14:55:28 [INFO] encoded CSR
2019/09/02 14:55:28 [INFO] Stored client certificate at /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts/cert.pem
2019/09/02 14:55:28 [INFO] Stored root CA certificate at /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/cacerts/192-168-1-10-7054.pem
2019/09/02 14:55:28 [INFO] Stored Issuer public key at /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/IssuerPublicKey
2019/09/02 14:55:28 [INFO] Stored Issuer revocation public key at /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/IssuerRevocationPublicKey
-------------- showing identities ----------------------
Name: admin, Type: client, Affiliation: , Max Enrollments: -1, Attributes: [{Name:hf.Revoker Value:1 ECert:false} {Name:hf.IntermediateCA Value:1 ECert:false} {Name:hf.GenCRL Value:1 ECert:false} {Name:hf.Registrar.Attributes Value:* ECert:false} {Name:hf.AffiliationMgr Value:1 ECert:false} {Name:hf.Registrar.Roles Value:* ECert:false} {Name:hf.Registrar.DelegateRoles Value:* ECert:false}]
--------------------------------------------------------

----


.4. Register the organization's admin into our CA server

In the following example we are registering 3 admins:  acme, budget and orderer.

[source, bash]
----
$  ./register_admin.sh client acme-admin pw acme acme

current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/caserver/admin
total 16
drwxrwxr-x 3 ubuntu ubuntu 4096 Sep  2 14:55 .
drwxrwxr-x 3 ubuntu ubuntu 4096 Sep  2 14:55 ..
-rw-r--r-- 1 ubuntu ubuntu 3281 Sep  2 14:55 fabric-ca-client-config.yaml
drwx------ 6 ubuntu ubuntu 4096 Sep  2 14:55 msp
Registering: acme-admin
2019/09/02 14:55:56 [INFO] Configuration file location: /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/fabric-ca-client-config.yaml
Password: pw
NOTE:  inform the user <acme-admin> and password <pw> to the admin of the organization <acme> (this information is also required to enroll organizations clients)

----

[source, bash]
----
$ ./register_admin.sh client budget-admin pw budget budget

current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/caserver/admin
total 16
drwxrwxr-x 3 ubuntu ubuntu 4096 Sep  2 14:55 .
drwxrwxr-x 3 ubuntu ubuntu 4096 Sep  2 14:55 ..
-rw-r--r-- 1 ubuntu ubuntu 3281 Sep  2 14:55 fabric-ca-client-config.yaml
drwx------ 6 ubuntu ubuntu 4096 Sep  2 14:55 msp
Registering: budget-admin
2019/09/02 14:56:05 [INFO] Configuration file location: /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/fabric-ca-client-config.yaml
Password: pw
NOTE:  inform the user <budget-admin> and password <pw> to the admin of the organization <budget> (this information is also required to enroll organizations clients)
----


[source, bash]
----
$ ./register_admin.sh client orderer-admin pw orderer orderer

current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/caserver/admin
total 16
drwxrwxr-x 3 ubuntu ubuntu 4096 Sep  2 14:55 .
drwxrwxr-x 3 ubuntu ubuntu 4096 Sep  2 14:55 ..
-rw-r--r-- 1 ubuntu ubuntu 3281 Sep  2 14:55 fabric-ca-client-config.yaml
drwx------ 6 ubuntu ubuntu 4096 Sep  2 14:55 msp
registering an orderer , setting attributes
Registering: orderer-admin
2019/09/02 14:56:11 [INFO] Configuration file location: /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/fabric-ca-client-config.yaml
Password: pw
NOTE:  inform the user <orderer-admin> and password <pw> to the admin of the organization <orderer> (this information is also required to enroll organizations clients)
----




===== Organizations CA admin hosts (ca-admin)

Each organization has its own ca-adminstrator, which will enroll the client
registered by the CA-admin in the previous step.
We have deployed one node for each (org1-msp-1 , org1-msp-2, ordering-0)


.1. Enroll and setup the client for each admin organization (ca-client) into the
ca-server.

.1.1) Log into the org1-msp-1 node and run the following.

[source, bash]
----
$ vagrant ssh org1-msp-1

$ cd setup_scripts

$ ./enroll_admin_and_setup_msp.sh acme ca-admin 192.168.1.10

current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/acme/admin

/home/ubuntu/hyperledger_ws/ca-client/acme/admin/fabric-ca-client-config.yaml not found in /home/ubuntu/hyperledger_ws/ca-client/acme/admin/
creating : mkdir -p /home/ubuntu/hyperledger_ws/ca-client/acme/admin

Copy the Client Yaml from /home/ubuntu/hyperledger_ws/config_files/fabric-ca-client-config-acme.yaml
cp /home/ubuntu/hyperledger_ws/config_files/fabric-ca-client-config-acme.yaml /home/ubuntu/hyperledger_ws/ca-client/acme/admin/fabric-ca-client-config.yaml
checking with: ls /home/ubuntu/hyperledger_ws/ca-client/acme/admin/fabric-ca-client-config.yaml
/home/ubuntu/hyperledger_ws/ca-client/acme/admin/fabric-ca-client-config.yaml

Enrolling: acme-admin:
fabric-ca-client enroll -u http://acme-admin:pw@192.168.1.10:7054
2019/09/02 14:56:46 [INFO] generating key: &{A:ecdsa S:256}
2019/09/02 14:56:46 [INFO] encoded CSR
2019/09/02 14:56:46 [INFO] Stored client certificate at /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/signcerts/cert.pem
2019/09/02 14:56:46 [INFO] Stored root CA certificate at /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/cacerts/192-168-1-10-7054.pem
2019/09/02 14:56:46 [INFO] Stored Issuer public key at /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/IssuerPublicKey
2019/09/02 14:56:46 [INFO] Stored Issuer revocation public key at /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/IssuerRevocationPublicKey

Creating /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts
====> /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts

copying /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts/*  to /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts
directory /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts does not exist locally
getting admin certs using scp
scp ca-admin:/home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts/* /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts
cert.pem                                                                             100%  851     0.8KB/s   00:00
checking with: ls /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts/
cert.pem
create /home/ubuntu/hyperledger_ws/ca-client/acme/admin/../msp subfolders
scp ca-admin:/home/ubuntu/hyperledger_ws/ca-server/ca-cert.pem /home/ubuntu/hyperledger_ws/ca-client/acme/admin/../msp/cacerts
ca-cert.pem                                                                          100%  761     0.7KB/s   00:00

cp /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/signcerts/* /home/ubuntu/hyperledger_ws/ca-client/acme/admin/../msp/admincerts

--------------------------------------------------------
Created MSP for org: acme at: /home/ubuntu/hyperledger_ws/ca-client/acme/admin/..
-------------- Listing Identities ----------------------
Name: acme-admin, Type: client, Affiliation: acme, Max Enrollments: 2, Attributes: [{Name:hf.Registrar.Roles Value:peer,user,client ECert:false} {Name:hf.AffiliationMgr Value:true ECert:false} {Name:hf.Revoker Value:true ECert:false} {Name:hf.EnrollmentID Value:acme-admin ECert:true} {Name:hf.Type Value:client ECert:true} {Name:hf.Affiliation Value:acme ECert:true}]
--------------------------------------------------------
----


.1.2)  Log into the org2-msp-2 node and run the following.

[source, bash]
----
$ vagrant ssh org2-msp-2

$ cd setup_scripts

$ ./enroll_admin.sh budget

./enroll_admin.sh budget
my FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/budget/admin
/home/ubuntu/hyperledger_ws/ca-client/budget/admin/fabric-ca-client-config.yaml not found in /home/ubuntu/hyperledger_ws/ca-client/budget/admin/
Copy the Client Yaml from /home/ubuntu/hyperledger_ws/config_files/fabric-ca-client-config-budget.yaml
/home/ubuntu/hyperledger_ws/ca-client/budget/admin/fabric-ca-client-config.yaml
Enrolling: budget-admin
fabric-ca-client enroll -u http://budget-admin:pw@192.168.1.10:7054
2019/08/28 09:31:19 [INFO] generating key: &{A:ecdsa S:256}
2019/08/28 09:31:19 [INFO] encoded CSR
2019/08/28 09:31:19 [INFO] Stored client certificate at /home/ubuntu/hyperledger_ws/ca-client/budget/admin/msp/signcerts/cert.pem
2019/08/28 09:31:19 [INFO] Stored root CA certificate at /home/ubuntu/hyperledger_ws/ca-client/budget/admin/msp/cacerts/192-168-1-10-7054.pem
2019/08/28 09:31:19 [INFO] Stored Issuer public key at /home/ubuntu/hyperledger_ws/ca-client/budget/admin/msp/IssuerPublicKey
2019/08/28 09:31:19 [INFO] Stored Issuer revocation public key at /home/ubuntu/hyperledger_ws/ca-client/budget/admin/msp/IssuerRevocationPublicKey
----

.1.3) Log into the ordering-0 node and run the following.

[source, bash]
----
$ vagrant ssh ordering-0

$ cd setup_scripts

$ ./enroll_admin_and_setup_msp.sh orderer ca-admin 192.168.1.10

current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/orderer/admin
/home/ubuntu/hyperledger_ws/ca-client/orderer/admin/fabric-ca-client-config.yaml not found in /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/
creating : mkdir -p /home/ubuntu/hyperledger_ws/ca-client/orderer/admin
Copy the Client Yaml from /home/ubuntu/hyperledger_ws/config_files/fabric-ca-client-config-orderer.yaml
cp /home/ubuntu/hyperledger_ws/config_files/fabric-ca-client-config-orderer.yaml /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/fabric-ca-client-config.yaml
checking with: ls /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/fabric-ca-client-config.yaml
/home/ubuntu/hyperledger_ws/ca-client/orderer/admin/fabric-ca-client-config.yaml
Enrolling: orderer-admin:
fabric-ca-client enroll -u http://orderer-admin:pw@192.168.1.10:7054
2019/09/02 14:57:50 [INFO] generating key: &{A:ecdsa S:256}
2019/09/02 14:57:50 [INFO] encoded CSR
2019/09/02 14:57:51 [INFO] Stored client certificate at /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/signcerts/cert.pem
2019/09/02 14:57:51 [INFO] Stored root CA certificate at /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/cacerts/192-168-1-10-7054.pem
2019/09/02 14:57:51 [INFO] Stored Issuer public key at /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/IssuerPublicKey
2019/09/02 14:57:51 [INFO] Stored Issuer revocation public key at /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/IssuerRevocationPublicKey
Creating /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/admincerts
====> /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/admincerts
copying /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts/*  to /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/admincerts
directory /home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts does not exist locally
getting admin certs using scp
scp ca-admin:/home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts/* /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/admincerts
The authenticity of host '192.168.1.10 (192.168.1.10)' cant be established.
ECDSA key fingerprint is SHA256:h4NspijfcEHWNxCvWz7QjORMn+1/KO6PCSJz41vE1ws.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.10' (ECDSA) to the list of known hosts.
cert.pem                                                                             100%  851     0.8KB/s   00:00
checking with: ls /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/admincerts/
cert.pem
create /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/../msp subfolders
scp ca-admin:/home/ubuntu/hyperledger_ws/ca-server/ca-cert.pem /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/../msp/cacerts
ca-cert.pem                                                                          100%  761     0.7KB/s   00:00
cp /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/msp/signcerts/* /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/../msp/admincerts
--------------------------------------------------------
Created MSP for org: orderer at: /home/ubuntu/hyperledger_ws/ca-client/orderer/admin/..
----



.2. Check the CA-server identity list

Go back to the ca-admin host and run the following command.

[source, bash]
----
./list_ca-server_identity-list.sh

------------Fabric ENV -----------------
FABRIC_ORDERER_HOME=/home/ubuntu/hyperledger_ws/orderer
FABRIC_CA_CLIENT_CONFIG=fabric-ca-client-config.yaml
FABRIC_VERSION=1.4.0
FABRIC_CONFIG_FILES=/home/ubuntu/hyperledger_ws/config_files
FABRIC_LOGGING_SPEC=INFO
FABRIC_USER=ubuntu
FABRIC_CA_SERVER_HOME=/home/ubuntu/hyperledger_ws/ca-server
FABRIC_CA_SERVER_CONFIG=fabric-ca-server-config.yaml
FABRIC_CFG_PATH=/home/ubuntu/hyperledger_ws/orderer
FABRIC_CA_SERVER_LOG=/home/ubuntu/hyperledger_ws/ca-server/ca-server.log
FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client

------------Setting HOME ---------------
current FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client
now FABRIC_CA_CLIENT_HOME=/home/ubuntu/hyperledger_ws/ca-client/caserver/admin

------------Listing Identities----------
Name: admin, Type: client, Affiliation: , Max Enrollments: -1, Attributes: [{Name:hf.Revoker Value:1 ECert:false} {Name:hf.IntermediateCA Value:1 ECert:false} {Name:hf.GenCRL Value:1 ECert:false} {Name:hf.Registrar.Attributes Value:* ECert:false} {Name:hf.AffiliationMgr Value:1 ECert:false} {Name:hf.Registrar.Roles Value:* ECert:false} {Name:hf.Registrar.DelegateRoles Value:* ECert:false}]

Name: acme-admin, Type: client, Affiliation: acme, Max Enrollments: 2, Attributes: [{Name:hf.Registrar.Roles Value:peer,user,client ECert:false} {Name:hf.AffiliationMgr Value:true ECert:false} {Name:hf.Revoker Value:true ECert:false} {Name:hf.EnrollmentID Value:acme-admin ECert:true} {Name:hf.Type Value:client ECert:true} {Name:hf.Affiliation Value:acme ECert:true}]

Name: budget-admin, Type: client, Affiliation: budget, Max Enrollments: 2, Attributes: [{Name:hf.Registrar.Roles Value:peer,user,client ECert:false} {Name:hf.AffiliationMgr Value:true ECert:false} {Name:hf.Revoker Value:true ECert:false} {Name:hf.EnrollmentID Value:budget-admin ECert:true} {Name:hf.Type Value:client ECert:true} {Name:hf.Affiliation Value:budget ECert:true}]

Name: orderer-admin, Type: client, Affiliation: orderer, Max Enrollments: 2, Attributes: [{Name:hf.Registrar.Roles Value:orderer ECert:false} {Name:hf.EnrollmentID Value:orderer-admin ECert:true} {Name:hf.Type Value:client ECert:true} {Name:hf.Affiliation Value:orderer ECert:true}]
----------------------------------------
----




== Summary

.Files and directories created by each scripts

[width="100%",cols="25,25,25,25",options="header"]
|=========================================================
|script/host-path  | ca-admin/ca-server | ca-admin/ca-client | org-msp/ca-client

| start-ca-server.sh | /home/ubuntu/hyperledger_ws/ca-server/fabric-ca-server-config.yaml   | |
| | ca-server/ca-cert.pem (*CA certificate*)| |
| | ca-server/IssuerPublicKey (*Issuer pub key*)| |
| | ca-server/msp/keystore/IssuerSecretKey (*Issuer priv key*)| |
| | ca-server/IssuerRevocationPublicKey  | |
| | ca-server/msp/keystore/IssuerRevocationPrivateKey | |

| enroll_bootstrap_identity.sh |  |  |
| | | ca-client/caserver/admin/msp/signcerts/cert.pem
(*client certificate*)  |
| | | ca-client/caserver/admin/msp/cacerts/192-168-1-10-7054.pem (*ca-root certificate*)   |
| | | ca-client/caserver/admin/msp/IssuerPublicKey (*Issuer public key*) |
| | | ca-client/caserver/admin/msp/IssuerRevocationPublicKey (*Issuer revocation public key*) |

| register_admin.sh | n/a | n/a | n/a

| enroll_admin.sh 'acme' | | | /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/signcerts/cert.pem (*client certificate*)
| | | |  /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/cacerts/192-168-1-10-7054.pem (*root CA certificate*)
| | | | /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/IssuerPublicKey (*Issuer public key*)
| | | | /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/IssuerRevocationPublicKey  (*Issuer revocation public key*)

| ./setup_admin_certs.sh acme ca-admin | | | creates /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts
| | | |  scp ca-admin:/home/ubuntu/hyperledger_ws/ca-client/caserver/admin/msp/signcerts/* /home/ubuntu/hyperledger_ws/ca-client/acme/admin/msp/admincerts
| | | | scp ca-admin:/home/ubuntu/hyperledger_ws/ca-server/ca-cert.pem /home/ubuntu/hyperledger_ws/ca-client/acme/admin/../msp/cacerts

|=========================================================




=== Other Notes

==== variables

- pwd = HLF2/ca/multi-org-ca

- DEFAULT_SERVER_CONFIG_YAML="HLF2/setup/config/multi-org-ca/yaml.0/fabric-ca-server-config.yaml"
- DEFAULT_CLIENT_CONFIG_YAML="HLF2/setup/config/multi-org-ca/yaml.0/fabric-ca-client-config.yaml"
- export FABRIC_CA_SERVER_HOME=HLF2/ca/multi-org-ca/server



==== start_server.sh

. cp $DEFAULT_SERVER_CONFIG_YAML  ./server
. fabric-ca-server start 2> $FABRIC_CA_SERVER_HOME/server.log

==== Enroll the bootstrap admin identity  (enroll_bootstrap.sh)

. FABRIC_CA_CLIENT_HOME=HLF2/ca/multi-org-ca/client/caserver/admin
. mkdir -p $FABRIC_CA_CLIENT_HOME
. cp $DEFAULT_CLIENT_CONFIG_YAML  "$FABRIC_CA_CLIENT_HOME/"


==== Register admins

. source setclient.sh   caserver   admin
. # acme-admin:

 fabric-ca-client register --id.type client --id.name acme-admin --id.secret pw --id.affiliation acme --id.attrs $ATTRIBUTES

. # budget-admin:

 fabric-ca-client register --id.type client --id.name budget-admin --id.secret pw --id.affiliation budget --id.attrs $ATTRIBUTES

. # orderer-admin:

 fabric-ca-client register --id.type client --id.name orderer-admin --id.secret pw --id.affiliation orderer --id.attrs $ATTRIBUTES

==== Enroll admins

===== acme-admin:

. ORG_NAME="acme"
. source setclient.sh   $ORG_NAME   admin
.. FABRIC_CA_CLIENT_HOME=HLF2/ca/multi-org-ca/client/acme/admin
. copy-yaml:
.. SETUP_CONFIG_CLIENT_YAML="HLF2/setup/config/multi-org-ca/yaml.0"
.. mkdir -p $FABRIC_CA_CLIENT_HOME
.. cp "HLF2/setup/config/multi-org-ca/yaml.0/acme/fabric-ca-client-config.yaml" "HLF2/ca/multi-org-ca/client/acme/admin/fabric-ca-client-config.yaml"
. fabric-ca-client enroll -u http://acme-admin:pw@localhost:7054
. setup:
.. ORG_NAME=acme
.. source setclient.sh $ORG_NAME  admin
... FABRIC_CA_CLIENT_HOME=HLF2/ca/multi-org-ca/client/acme
.. ROOT_CA_CERTIFICATE=./server/ca-cert.pem
.. DESTINATION_CLIENT_HOME="HLF2/ca/multi-org-ca/client/acme"
.. mkdir -p $HLF2/ca/multi-org-ca/client/acme/msp/admincerts
.. mkdir -p $HLF2/ca/multi-org-ca/client/acme/msp/cacerts
.. mkdir -p $HLF2/ca/multi-org-ca/client/acme/msp/keystore

.. *# Copy the Root CA Cert*
... cp ./server/ca-cert.pem $HLF2/ca/multi-org-ca/client/acme/msp/cacerts
.. *# Copy the admin certs - ORG admin is the admin for the specified Org*
... cp HLF2/ca/multi-org-ca/client/acme/msp/signcerts/* HLF2/ca/multi-org-ca/client/acme/msp/admincerts

==== Register Enroll orderer:

- pwd=HLF2/orderer/multi-org-ca/

. IDENTITY="admin"
. CA_CLIENT_FOLDER="../../ca/multi-org-ca/client/orderer"
. FABRIC_CA_CLIENT_HOME="HLF2/ca/multi-org-ca/client/orderer/admin"
. SETUP_CONFIG_CLIENT_YAML="HLF2/setup/config/multi-org-ca/yaml.0/identities/orderer/fabric-ca-client-config.yaml"
. mkdir -p HLF2/ca/multi-org-ca/client/orderer/admin
. cp  "HLF2/setup/config/multi-org-ca/yaml.0/identities/orderer/fabric-ca-client-config.yaml" "HLF2/ca/multi-org-ca/client/orderer/admin/fabric-ca-client-config.yaml"
. fabric-ca-client enroll -u http://orderer:pw@localhost:7054
. mkdir -p $FABRIC_CA_CLIENT_HOME/msp/admincerts
. cp $ADMIN_CLIENT_HOME/msp/signcerts/*    $FABRIC_CA_CLIENT_HOME/msp/admincerts






== Appendix A - Configuration files

[[appendix:vagrantfile]]
=== Vagrantfile

[source, ruby]
----
# -*- mode: ruby -*-
# vi: set ft=ruby :

require 'vagrant-openstack-provider'

cluster = [
    {
        :name => "msp-root-org1",
        :type => "caserver",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid => "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.10",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "msp-admin-org1",
        :type => "msp-admin",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.11",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "msp-admin-org2",
        :type => "msp-admin",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.12",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "msp-admin-orderer",
        :type => "msp-admin",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.13",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "orderer-node",
        :type => "orderer",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.14",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "peer1-org1",
        :type => "peer",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.15",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "peer1-org2",
        :type => "peer",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.16",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "peer2-org1",
        :type => "peer",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.17",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    },
    {
        :name => "peer2-org2",
        :type => "peer",
        :username => "ubuntu",
        :box => "hbr_ubuntu1604_img",
        :flavor => "j1.small",
        :netid =>  "d085327f-2cea-4e14-8784-764ee72b92f4",
        :netadd => "192.168.1.18",
        :privkeyfile => "~/.ssh/openstack_cloudlab_bcom.key"
    }

]

# data structs for creating the config file in ~/.ssh
ssh_config = []
ssh_entry = { :hostname => "", :username => "" , :ipadd => "", :keyfile => "" }

# data structs for updating the resolv.conf file
dns_config = []
dns_entry = { :hostname => "", :ipadd => "" }

# initialization scripts

$setSSHDNSconfig = <<-SCRIPT
    echo "-------------------------------------------"
    echo "allNodes script started"
    # setup ~/.ssh/config file at all the nodes to allow connection among them.
    # (after deployment only the floating IP of the first vm is required to connect)
    echo "Setting ~/.ssh/config"
    mv /home/ubuntu/hyperledger_ws/config_files/ssh_config_template /home/ubuntu/.ssh/config
    mv /home/ubuntu/hyperledger_ws/install/openstack_cloudlab_bcom.key    /home/ubuntu/.ssh/openstack_cloudlab_bcom.key
    chown ubuntu:ubuntu /home/ubuntu/.ssh/config /home/ubuntu/.ssh/openstack_cloudlab_bcom.key
    echo "-------------------------------------------"
    echo "Setting /etc/hosts"
    if [ -f /etc/hosts ]; then
        echo " " | tee -a /etc/hosts
        cat /home/ubuntu/hyperledger_ws/config_files/dns_config_template | tee -a /etc/hosts
    else
        echo "Warning: /etc/hosts does not exist"
    fi
    echo "-------------------------------------------"
        echo "Setting terminal layouts."
        mkdir -p /home/ubuntu/.byobu/
        cp /home/ubuntu/hyperledger_ws/install/windows.tmux.hlf /home/ubuntu/.byobu/windows.tmux.hlf
        echo "-------------------------------------------"
SCRIPT


#vagrant config
Vagrant.configure("2") do |config|

    config.ssh.username = "ubuntu"
    config.ssh.private_key_path = '/home/rheverson/.ssh/openstack_cloudlab_bcom.key'

    config.vm.provider :openstack do |os|
        os.openstack_auth_url = 'http://10.50.0.103:5000/v2.0'
        os.username = '<user_name>'
        os.password = '****'
        os.tenant_name = '<project-name>'
        os.security_groups = ['default']
        os.availability_zone = 'nova'
        os.region = 'regionOne'
        os.keypair_name = 'openstack_cloudlab_bcom'

    end

    cluster.each do |opts|
        config.vm.define opts[:name] do |node|
            node.vm.provider :openstack do |os, override|
                os.server_name = opts[:name]
                os.image = opts[:box]
                os.flavor = opts[:flavor]
                os.networks = [{ id: opts[:netid], address: opts[:netadd] }]
                os.floating_ip_pool = 'ext_net'
                override.vm.synced_folder '.', '/vagrant', disabled: true  # this
                override.vm.synced_folder './shared', '/home/ubuntu/hyperledger_ws/', type: 'rsync'
                # Sets resolv.conf
                os.user_data = """#!/bin/bash
                    echo 'nameserver 8.8.8.8'  | tee -a /etc/resolv.conf
                """
            end
            ## for all:
            node.vm.provision "shell", inline: $setSSHDNSconfig
        end

        new_ssh_entry = Hash.new()
        new_ssh_entry[:hostname] = opts[:name]
        new_ssh_entry[:username] = opts[:username]
        new_ssh_entry[:ipadd] = opts[:netadd]
        new_ssh_entry[:keyfile] = opts[:privkeyfile]
        ssh_config.push << new_ssh_entry

        new_dns_entry = Hash.new()
        new_dns_entry[:hostname] = opts[:name]
        new_dns_entry[:ipadd] = opts[:netadd]
        dns_config.push << new_dns_entry
    end

    # Create a ssh config
    File.open("./shared/config_files/ssh_config_template", "w+") do |f|
        ssh_config.each { |element| f.puts("Host " + element[:hostname].to_s, "     User " + element[:username].to_s, "     Hostname " + element[:ipadd].to_s, "     IdentityFile " + element[:keyfile].to_s) }
    end

    # Create the dns config
    File.open("./shared/config_files/dns_config_template", "w+") do |f|
        dns_config.each { |element| f.puts(element[:ipadd].to_s + "   " + element[:hostname].to_s) }
    end
end
----

<<conf-overview, [back]>>



== Appendix B: Installation logs


=== Docker install output log

[[appendix:installdocker]]
[source, bash]
----
$ ./01_install_docker.sh
--------------------------------------------------------------------------------
  Installing docker...
--------------------------------------------------------------------------------
installing with user: ubuntu

source /home/ubuntu/hyperledger_ws/install/fabric.env.sh
Hit:1 http://nova.clouds.archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates InRelease [109 kB]
Get:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]
Get:4 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]
Get:5 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main Sources [341 kB]
Get:6 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [1046 kB]
Get:7 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [767 kB]
Fetched 2479 kB in 1s (1915 kB/s)
Reading package lists... Done
Reading package lists... Done
Building dependency tree
Reading state information... Done
curl is already the newest version (7.47.0-1ubuntu2.14).
The following additional packages will be installed:
  libassuan0 libnpth0 pinentry-curses python3-software-properties
Suggested packages:
  pinentry-doc
The following NEW packages will be installed:
  gnupg-agent libassuan0 libnpth0 pinentry-curses
The following packages will be upgraded:
  apt-transport-https ca-certificates python3-software-properties software-properties-common
4 upgraded, 4 newly installed, 0 to remove and 115 not upgraded.
Need to get 537 kB of archives.
After this operation, 1202 kB of additional disk space will be used.
Get:1 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main amd64 apt-transport-https amd64 1.2.32 [26.5 kB]
Get:2 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main amd64 ca-certificates all 20170717~16.04.2 [167 kB]
Get:3 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/main amd64 libassuan0 amd64 2.4.2-2 [34.6 kB]
Get:4 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/main amd64 pinentry-curses amd64 0.9.7-3 [31.2 kB]
Get:5 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/main amd64 libnpth0 amd64 1.2-3 [7998 B]
Get:6 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main amd64 gnupg-agent amd64 2.1.11-6ubuntu2.1 [240 kB]
Get:7 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main amd64 software-properties-common all 0.96.20.9 [9452 B]
Get:8 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates/main amd64 python3-software-properties all 0.96.20.9 [20.1 kB]
Fetched 537 kB in 0s (590 kB/s)
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_TIME = "fr_FR.UTF-8",
	LC_MONETARY = "fr_FR.UTF-8",
	LC_ADDRESS = "fr_FR.UTF-8",
	LC_TELEPHONE = "fr_FR.UTF-8",
	LC_NAME = "fr_FR.UTF-8",
	LC_MEASUREMENT = "fr_FR.UTF-8",
	LC_IDENTIFICATION = "fr_FR.UTF-8",
	LC_NUMERIC = "fr_FR.UTF-8",
	LC_PAPER = "fr_FR.UTF-8",
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to a fallback locale ("en_US.UTF-8").
locale: Cannot set LC_ALL to default locale: No such file or directory
Preconfiguring packages ...
(Reading database ... 82018 files and directories currently installed.)
Preparing to unpack .../apt-transport-https_1.2.32_amd64.deb ...
Unpacking apt-transport-https (1.2.32) over (1.2.29ubuntu0.1) ...
Preparing to unpack .../ca-certificates_20170717~16.04.2_all.deb ...
Unpacking ca-certificates (20170717~16.04.2) over (20170717~16.04.1) ...
Selecting previously unselected package libassuan0:amd64.
Preparing to unpack .../libassuan0_2.4.2-2_amd64.deb ...
Unpacking libassuan0:amd64 (2.4.2-2) ...
Selecting previously unselected package pinentry-curses.
Preparing to unpack .../pinentry-curses_0.9.7-3_amd64.deb ...
Unpacking pinentry-curses (0.9.7-3) ...
Selecting previously unselected package libnpth0:amd64.
Preparing to unpack .../libnpth0_1.2-3_amd64.deb ...
Unpacking libnpth0:amd64 (1.2-3) ...
Selecting previously unselected package gnupg-agent.
Preparing to unpack .../gnupg-agent_2.1.11-6ubuntu2.1_amd64.deb ...
Unpacking gnupg-agent (2.1.11-6ubuntu2.1) ...
Preparing to unpack .../software-properties-common_0.96.20.9_all.deb ...
Unpacking software-properties-common (0.96.20.9) over (0.96.20.7) ...
Preparing to unpack .../python3-software-properties_0.96.20.9_all.deb ...
Unpacking python3-software-properties (0.96.20.9) over (0.96.20.7) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for dbus (1.10.6-1ubuntu3.4) ...
Setting up apt-transport-https (1.2.32) ...
Setting up ca-certificates (20170717~16.04.2) ...
locale: Cannot set LC_ALL to default locale: No such file or directory
Setting up libassuan0:amd64 (2.4.2-2) ...
Setting up pinentry-curses (0.9.7-3) ...
Setting up libnpth0:amd64 (1.2-3) ...
Setting up gnupg-agent (2.1.11-6ubuntu2.1) ...
Setting up python3-software-properties (0.96.20.9) ...
Setting up software-properties-common (0.96.20.9) ...
Processing triggers for ca-certificates (20170717~16.04.2) ...
Updating certificates in /etc/ssl/certs...
0 added, 0 removed; done.
Running hooks in /etc/ca-certificates/update.d...
done.
Processing triggers for libc-bin (2.23-0ubuntu10) ...
OK
Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease
Hit:2 http://nova.clouds.archive.ubuntu.com/ubuntu xenial InRelease
Get:3 https://download.docker.com/linux/ubuntu xenial InRelease [66.2 kB]
Hit:4 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates InRelease
Get:5 https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages [11.2 kB]
Hit:6 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-backports InRelease
Fetched 77.4 kB in 0s (103 kB/s)
Reading package lists... Done
--------------------------------------------------------------------------------
installing latest version of Docker
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following additional packages will be installed:
  aufs-tools cgroupfs-mount libltdl7 pigz
Suggested packages:
The following NEW packages will be installed:
  aufs-tools cgroupfs-mount containerd.io docker-ce docker-ce-cli libltdl7 pigz
0 upgraded, 7 newly installed, 0 to remove and 115 not upgraded.
Need to get 85.1 MB of archives.
After this operation, 384 MB of additional disk space will be used.
Get:1 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/universe amd64 pigz amd64 2.3.1-2 [61.1 kB]
Get:2 https://download.docker.com/linux/ubuntu xenial/stable amd64 containerd.io amd64 1.2.10-2 [19.8 MB]
Get:3 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/universe amd64 aufs-tools amd64 1:3.2+20130722-1.1ubuntu1 [92.9 kB]
Get:4 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce-cli amd64 5:19.03.3~3-0~ubuntu-xenial [42.3 MB]
Get:5 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/universe amd64 cgroupfs-mount all 1.2 [4970 B]
Get:6 http://nova.clouds.archive.ubuntu.com/ubuntu xenial/main amd64 libltdl7 amd64 2.4.6-0.1 [38.3 kB]
Get:7 https://download.docker.com/linux/ubuntu xenial/stable amd64 docker-ce amd64 5:19.03.3~3-0~ubuntu-xenial [22.8 MB]
Fetched 85.1 MB in 6s (14.0 MB/s)
Selecting previously unselected package pigz.
(Reading database ... 82057 files and directories currently installed.)
Preparing to unpack .../pigz_2.3.1-2_amd64.deb ...
Unpacking pigz (2.3.1-2) ...
Selecting previously unselected package aufs-tools.
Preparing to unpack .../aufs-tools_1%3a3.2+20130722-1.1ubuntu1_amd64.deb ...
Unpacking aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Selecting previously unselected package cgroupfs-mount.
Preparing to unpack .../cgroupfs-mount_1.2_all.deb ...
Unpacking cgroupfs-mount (1.2) ...
Selecting previously unselected package containerd.io.
Preparing to unpack .../containerd.io_1.2.10-2_amd64.deb ...
Unpacking containerd.io (1.2.10-2) ...
Selecting previously unselected package docker-ce-cli.
Preparing to unpack .../docker-ce-cli_5%3a19.03.3~3-0~ubuntu-xenial_amd64.deb ...
Unpacking docker-ce-cli (5:19.03.3~3-0~ubuntu-xenial) ...
Selecting previously unselected package docker-ce.
Preparing to unpack .../docker-ce_5%3a19.03.3~3-0~ubuntu-xenial_amd64.deb ...
Unpacking docker-ce (5:19.03.3~3-0~ubuntu-xenial) ...
Selecting previously unselected package libltdl7:amd64.
Preparing to unpack .../libltdl7_2.4.6-0.1_amd64.deb ...
Unpacking libltdl7:amd64 (2.4.6-0.1) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for ureadahead (0.100.0-19) ...
Processing triggers for systemd (229-4ubuntu21.21) ...
Setting up pigz (2.3.1-2) ...
Setting up aufs-tools (1:3.2+20130722-1.1ubuntu1) ...
Setting up cgroupfs-mount (1.2) ...
Setting up containerd.io (1.2.10-2) ...
Setting up docker-ce-cli (5:19.03.3~3-0~ubuntu-xenial) ...
Setting up docker-ce (5:19.03.3~3-0~ubuntu-xenial) ...
Setting up libltdl7:amd64 (2.4.6-0.1) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for systemd (229-4ubuntu21.21) ...
Processing triggers for ureadahead (0.100.0-19) ...
--------------------------------------------------------------------------------
setting docker to run as non-root
Adding user ubuntu to group docker
END of Docker installation -----------------------------------------------------

----


<<docker_install, [back]>>



=== Fabric requirements install output log

[[appendix:req_install]]
[source, bash]
----
$ ./02_install_prereqs.sh
--------------------------------------------------------------------------------
Installing Fabric Pre-requirements
--------------------------------------------------------------------------------
installing for user: ubuntu
fabric_home: /home/ubuntu/hyperledger_ws
/usr/local/go
/home/ubuntu/hyperledger_ws/go
/home/ubuntu/bin:/home/ubuntu/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/go/bin:/home/ubuntu/hyperledger_ws/go/bin:/home/ubuntu/hyperledger_ws/bin:/usr/local/go/bin:/home/ubuntu/hyperledger_ws/go/bin:/home/ubuntu/hyperledger_ws/bin
-----------------------------------------------------------------------------------------
source /home/ubuntu/hyperledger_ws/install/fabric.env.sh
source /home/ubuntu/hyperledger_ws/install/fabric.env.sh already in /home/ubuntu/.bashrc. Doing nothing!
cd $HYPERLEDGER_HOME
--------------------------------------------------------------------------------
Checking ubuntu version...
Installing prereqs for Ubuntu xenial
--------------------------------------------------------------------------------
Updating package lists
--------------------------------------------------------------------------------
Installing Golang
--------------------------------------------------------------------------------
==> Download finished. uncompressing.
===> decompressing go1.12.2.linux-amd64.tar.gz
===> removing go1.12.2.linux-amd64.tar.gz
--------------------------------------------------------------------------------
Downloading Node.js:  requested for developement only...
## Installing the NodeSource Node.js 8.x LTS Carbon repo...
## Populating apt-get cache...

+ apt-get update
Hit:1 http://nova.clouds.archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]
Hit:3 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates InRelease
Get:4 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]
Hit:5 https://download.docker.com/linux/ubuntu xenial InRelease
Fetched 216 kB in 2s (98.6 kB/s)
Reading package lists... Done

## Confirming "xenial" is supported...
+ curl -sLf -o /dev/null 'https://deb.nodesource.com/node_8.x/dists/xenial/Release'

## Adding the NodeSource signing key to your keyring...
+ curl -s https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add -
OK

## Creating apt sources list file for the NodeSource Node.js 8.x LTS Carbon repo...
+ echo 'deb https://deb.nodesource.com/node_8.x xenial main' > /etc/apt/sources.list.d/nodesource.list
+ echo 'deb-src https://deb.nodesource.com/node_8.x xenial main' >> /etc/apt/sources.list.d/nodesource.list

## Running `apt-get update` for you...
+ apt-get update
Hit:1 http://nova.clouds.archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]
Hit:3 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-updates InRelease
Get:4 http://nova.clouds.archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]
Get:5 https://deb.nodesource.com/node_8.x xenial InRelease [4619 B]
Hit:6 https://download.docker.com/linux/ubuntu xenial InRelease
Get:7 https://deb.nodesource.com/node_8.x xenial/main Sources [761 B]
Get:8 https://deb.nodesource.com/node_8.x xenial/main amd64 Packages [1008 B]
Fetched 222 kB in 0s (310 kB/s)
Reading package lists... Done

## Run `sudo apt-get install -y nodejs` to install Node.js 8.x LTS Carbon and npm
## You may also need development tools to build native addons:
     sudo apt-get install gcc g++ make
## To install the Yarn package manager, run:
     curl -sL https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
     echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
     sudo apt-get update && sudo apt-get install yarn

--------------------------------------------------------------------------------
Installing Node.js and nmp
--------------------------------------------------------------------------------
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_TIME = "fr_FR.UTF-8",
	LC_MONETARY = "fr_FR.UTF-8",
	LC_ADDRESS = "fr_FR.UTF-8",
	LC_TELEPHONE = "fr_FR.UTF-8",
	LC_NAME = "fr_FR.UTF-8",
	LC_MEASUREMENT = "fr_FR.UTF-8",
	LC_IDENTIFICATION = "fr_FR.UTF-8",
	LC_NUMERIC = "fr_FR.UTF-8",
	LC_PAPER = "fr_FR.UTF-8",
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to a fallback locale ("en_US.UTF-8").
locale: Cannot set LC_ALL to default locale: No such file or directory
Selecting previously unselected package libpython2.7-minimal:amd64.
(Reading database ... 82362 files and directories currently installed.)
Preparing to unpack .../libpython2.7-minimal_2.7.12-1ubuntu0~16.04.9_amd64.deb ...
Unpacking libpython2.7-minimal:amd64 (2.7.12-1ubuntu0~16.04.9) ...
Selecting previously unselected package python2.7-minimal.
Preparing to unpack .../python2.7-minimal_2.7.12-1ubuntu0~16.04.9_amd64.deb ...
Unpacking python2.7-minimal (2.7.12-1ubuntu0~16.04.9) ...
Selecting previously unselected package python-minimal.
Preparing to unpack .../python-minimal_2.7.12-1~16.04_amd64.deb ...
Unpacking python-minimal (2.7.12-1~16.04) ...
Selecting previously unselected package libpython2.7-stdlib:amd64.
Preparing to unpack .../libpython2.7-stdlib_2.7.12-1ubuntu0~16.04.9_amd64.deb ...
Unpacking libpython2.7-stdlib:amd64 (2.7.12-1ubuntu0~16.04.9) ...
Selecting previously unselected package python2.7.
Preparing to unpack .../python2.7_2.7.12-1ubuntu0~16.04.9_amd64.deb ...
Unpacking python2.7 (2.7.12-1ubuntu0~16.04.9) ...
Selecting previously unselected package libpython-stdlib:amd64.
Preparing to unpack .../libpython-stdlib_2.7.12-1~16.04_amd64.deb ...
Unpacking libpython-stdlib:amd64 (2.7.12-1~16.04) ...
Processing triggers for man-db (2.7.5-1) ...
Processing triggers for mime-support (3.59ubuntu1) ...
Setting up libpython2.7-minimal:amd64 (2.7.12-1ubuntu0~16.04.9) ...
Setting up python2.7-minimal (2.7.12-1ubuntu0~16.04.9) ...
Linking and byte-compiling packages for runtime python2.7...
Setting up python-minimal (2.7.12-1~16.04) ...
Selecting previously unselected package python.
(Reading database ... 83108 files and directories currently installed.)
Preparing to unpack .../python_2.7.12-1~16.04_amd64.deb ...
Unpacking python (2.7.12-1~16.04) ...
Selecting previously unselected package nodejs.
Preparing to unpack .../nodejs_8.16.2-1nodesource1_amd64.deb ...
Unpacking nodejs (8.16.2-1nodesource1) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up libpython2.7-stdlib:amd64 (2.7.12-1ubuntu0~16.04.9) ...
Setting up python2.7 (2.7.12-1ubuntu0~16.04.9) ...
Setting up libpython-stdlib:amd64 (2.7.12-1~16.04) ...
Setting up python (2.7.12-1~16.04) ...
Setting up nodejs (8.16.2-1nodesource1) ...
/usr/bin/npm -> /usr/lib/node_modules/npm/bin/npm-cli.js
/usr/bin/npx -> /usr/lib/node_modules/npm/bin/npx-cli.js
+ npm@5.6.0
added 363 packages from 147 contributors, removed 274 packages and updated 43 packages in 16.721s

--------------------------------------------------------------------------------
Installing Python
--------------------------------------------------------------------------------
Reading package lists... Done
Building dependency tree
Reading state information... Done
tree is already the newest version (1.7.0-3).
0 upgraded, 0 newly installed, 0 to remove and 115 not upgraded.
--------------------------------------------------------------------------------
Prereqs install Done!

----
<<req_install, [back]>>


=== Check requirements output log

[[appendix:req_check]]
[source, bash]
----
~/hyperledger_ws/install$ ./check_prereqs.sh
--------------------------------------------
Checking prereqs with user: ubuntu
--------------------------------------------
installing for user: ubuntu
fabric_home: /home/ubuntu/hyperledger_ws
/usr/local/go
/home/ubuntu/hyperledger_ws/go
/home/ubuntu/bin:/home/ubuntu/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/go/bin:/home/ubuntu/hyperledger_ws/go/bin:/home/ubuntu/hyperledger_ws/bin:/usr/local/go/bin:/home/ubuntu/hyperledger_ws/go/bin:/home/ubuntu/hyperledger_ws/bin
---------------------------------------------
curl:
curl 7.47.0 (x86_64-pc-linux-gnu) libcurl/7.47.0 GnuTLS/3.4.10 zlib/1.2.8 libidn/1.32 librtmp/2.3
--------------------------------------------
golang:
go version go1.12.2 linux/amd64
--------------------------------------------
node.js:
v8.16.2
--------------------------------------------
Python:
Python 2.7.12
--------------------------------------------
npm:
5.6.0

----
<<req_check, [back]>>




=== Bootstrap binaries and images output log

[[appendix:fabric-bootstrap]]
[source, bash]
----
~/hyperledger_ws/install$ ./03_install_bootstrap.sh
--------------------------------------------------------------------------------
Bootstraping Fabric components...
--------------------------------------------------------------------------------
installing for user: ubuntu
fabric_home: /home/ubuntu/hyperledger_ws
/usr/local/go
/home/ubuntu/hyperledger_ws/go
/home/ubuntu/bin:/home/ubuntu/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/go/bin:/home/ubuntu/hyperledger_ws/go/bin:/home/ubuntu/hyperledger_ws/bin:/usr/local/go/bin:/home/ubuntu/hyperledger_ws/go/bin:/home/ubuntu/hyperledger_ws/bin
--------------------------------------------------------------------------------
bootstrap : Installing Hyperledger Fabric binaries
--------------------------------------------------------------------------------
===> [install_03_bootstrap.sh (getBinaries)] : Downloading version 1.4.0 platform specific fabric binaries
===> [install_03_bootstrap.sh (getBinaries)] : Downloading fabric from:  https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric/hyperledger-fabric/linux-amd64-1.4.0/hyperledger-fabric-linux-amd64-1.4.0.tar.gz
--------------------------------------------------------------------------------
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
100 50.9M  100 50.9M    0     0  2580k      0  0:00:20  0:00:20 --:--:-- 3724k
==> Done

moving config directory created by getBinaries to config_files only for backup
-----------------------------------------------------------------------------------------
===> [install_03_bootstrap.sh (getBinaries)] : Downloading version 1.4.0 platform specific fabric-ca-client binary
===> [install_03_bootstrap.sh (getBinaries)] : Downloading fabric-ca from:  https://nexus.hyperledger.org/content/repositories/releases/org/hyperledger/fabric-ca/hyperledger-fabric-ca/linux-amd64-1.4.0/hyperledger-fabric-ca-linux-amd64-1.4.0.tar.gz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
100 5979k  100 5979k    0     0   488k      0  0:00:12  0:00:12 --:--:-- 1050k
==> Done
--------------------------------------------------------------------------------
==> FABRIC IMAGE: peer
PULLING: docker pull hyperledger/fabric-peer:1.4.0
1.4.0: Pulling from hyperledger/fabric-peer
3b37166ec614: Pull complete
504facff238f: Pull complete
ebbcacd28e10: Pull complete
c7fb3351ecad: Pull complete
2e3debadcbf7: Pull complete
fc435e46e32e: Pull complete
a4922bafdce8: Pull complete
7d9964965066: Pull complete
625153a09c48: Pull complete
291344806a10: Pull complete
Digest: sha256:9707c97f787de1d4d6dd60994d6b8ea2e5cc28b0f42e6849df3fb41c64b41372
Status: Downloaded newer image for hyperledger/fabric-peer:1.4.0
docker.io/hyperledger/fabric-peer:1.4.0
TAGGING: docker tag hyperledger/fabric-peer:1.4.0 hyperledger/fabric-peer
--------------------------------------------------------------------------------
==> FABRIC IMAGE: orderer
PULLING: docker pull hyperledger/fabric-orderer:1.4.0
1.4.0: Pulling from hyperledger/fabric-orderer
1aa1f5822ea4: Pull complete
f3adcb95411e: Pull complete
Digest: sha256:644265186b4887c7d9dcb91895124ccead3c0125c2c4f9eadc421dc9555d7495
Status: Downloaded newer image for hyperledger/fabric-orderer:1.4.0
docker.io/hyperledger/fabric-orderer:1.4.0
TAGGING: docker tag hyperledger/fabric-orderer:1.4.0 hyperledger/fabric-orderer
--------------------------------------------------------------------------------
==> FABRIC IMAGE: ccenv
PULLING: docker pull hyperledger/fabric-ccenv:1.4.0
1.4.0: Pulling from hyperledger/fabric-ccenv
14675a1189ca: Pull complete
33f930d7053e: Pull complete
7aa21e006739: Pull complete
806ba27e29bb: Pull complete
0292b0ff822a: Pull complete
5d4ce0f5fd82: Pull complete
3bde20c14104: Pull complete
Digest: sha256:6d797cac9fd39d4c9964fbcf02e47137ce8ae321af60832c41d511f0c7ed4d3e
Status: Downloaded newer image for hyperledger/fabric-ccenv:1.4.0
docker.io/hyperledger/fabric-ccenv:1.4.0
TAGGING: docker tag hyperledger/fabric-ccenv:1.4.0 hyperledger/fabric-ccenv
--------------------------------------------------------------------------------
==> FABRIC IMAGE: tools
PULLING: docker pull hyperledger/fabric-tools:1.4.0
1.4.0: Pulling from hyperledger/fabric-tools
72b2b3c78600: Pull complete
f36a6f470154: Pull complete
19fc6d1044df: Pull complete
Digest: sha256:aee256916d0cb938d8023fa32ed2745991d32cfe79018e360f1720707ebfbdb5
Status: Downloaded newer image for hyperledger/fabric-tools:1.4.0
docker.io/hyperledger/fabric-tools:1.4.0
TAGGING: docker tag hyperledger/fabric-tools:1.4.0 hyperledger/fabric-tools
--------------------------------------------------------------------------------
==> FABRIC IMAGE: javaenv
PULLING: docker pull hyperledger/fabric-javaenv:1.4.0
1.4.0: Pulling from hyperledger/fabric-javaenv
af7eebe5d909: Pull complete
c0ad74369a8f: Pull complete
e36a0232c697: Pull complete
c44da90e9317: Pull complete
91686ed50f7f: Pull complete
1bc0e6d0fb0f: Pull complete
db373eca3e52: Pull complete
942e34fe9650: Pull complete
e49b8e9d853d: Pull complete
094ba7d3af94: Pull complete
4bf56bdf76e0: Pull complete
138eeaa643a0: Pull complete
2b405cbef2dc: Pull complete
386086ff2840: Pull complete
32bb4435cb82: Pull complete
3280cfa711dc: Pull complete
6b14cff5081c: Pull complete
04743de5a814: Pull complete
5360864ccda4: Pull complete
2fd4fc8d8137: Pull complete
bd0e3b20a1bb: Pull complete
a298ecbfeab2: Pull complete
c7b9277c5a65: Pull complete
201919c3a1fe: Pull complete
539bfc561087: Pull complete
4e779849c7ea: Pull complete
3a7304a5b624: Pull complete
Digest: sha256:f392f0c568e515b3e14c9afce14340ba18bc456cfd831ffcb4f72db58dbbcc34
Status: Downloaded newer image for hyperledger/fabric-javaenv:1.4.0
docker.io/hyperledger/fabric-javaenv:1.4.0
TAGGING: docker tag hyperledger/fabric-javaenv:1.4.0 hyperledger/fabric-javaenv
--------------------------------------------------------------------------------
==> THIRDPARTY DOCKER IMAGE: couchdb
PULLING: docker pull hyperledger/fabric-couchdb:0.4.15
0.4.15: Pulling from hyperledger/fabric-couchdb
34667c7e4631: Pull complete
d18d76a881a4: Pull complete
119c7358fbfc: Pull complete
2aaf13f3eff0: Pull complete
3f89de4cf84b: Pull complete
24194f819972: Pull complete
78e4eabd31a5: Pull complete
c7652b6bde40: Pull complete
b4646dd65c45: Pull complete
5e6defad8a30: Pull complete
7695bf5d0b9d: Pull complete
6d9d46f66bc3: Pull complete
4912f1b4990a: Pull complete
f3b174a93eea: Pull complete
3763a939777a: Pull complete
f293593adbb6: Pull complete
1ae53ace804f: Pull complete
d4aa6d764b18: Pull complete
d747b2b30e48: Pull complete
52cbd2253fea: Pull complete
Digest: sha256:f6c724592abf9c2b35d2f4cd6a7afcde9c1052cfed61560b20ef9e2e927d1790
Status: Downloaded newer image for hyperledger/fabric-couchdb:0.4.15
docker.io/hyperledger/fabric-couchdb:0.4.15
TAGGING: docker tag hyperledger/fabric-couchdb:0.4.15 hyperledger/fabric-couchdb
--------------------------------------------------------------------------------
==> THIRDPARTY DOCKER IMAGE: baseos
PULLING: docker pull hyperledger/fabric-baseos:0.4.15
0.4.15: Pulling from hyperledger/fabric-baseos
24194f819972: Already exists
Digest: sha256:b0f1d255d13e2e8b30c33aa3e8da524c2587107ea6fb7561e37c9441129e9ef1
Status: Downloaded newer image for hyperledger/fabric-baseos:0.4.15
docker.io/hyperledger/fabric-baseos:0.4.15
TAGGING: docker tag hyperledger/fabric-baseos:0.4.15 hyperledger/fabric-baseos
--------------------------------------------------------------------------------
===> IMPORTANT: Listing hyperledger docker images
REPOSITORY                   TAG      IMAGE ID        CREATED         SIZE
hyperledger/fabric-couchdb   0.4.15   8de128a55539    7 months ago    1.5GB
hyperledger/fabric-couchdb   latest   8de128a55539    7 months ago    1.5GB
hyperledger/fabric-baseos    0.4.15   9d6ec11c60ff    7 months ago    145MB
hyperledger/fabric-baseos    latest   9d6ec11c60ff    7 months ago    145MB
hyperledger/fabric-javaenv   1.4.0    3d91b3bf7118    9 months ago    1.75GB
hyperledger/fabric-javaenv   latest   3d91b3bf7118    9 months ago    1.75GB
hyperledger/fabric-tools     1.4.0    0a44f4261a55    9 months ago    1.56GB
hyperledger/fabric-tools     latest   0a44f4261a55    9 months ago    1.56GB
hyperledger/fabric-ccenv     1.4.0    5b31d55f5f3a    9 months ago    1.43GB
hyperledger/fabric-ccenv     latest   5b31d55f5f3a    9 months ago    1.43GB
hyperledger/fabric-orderer   1.4.0    54f372205580    9 months ago    150MB
hyperledger/fabric-orderer   latest   54f372205580    9 months ago    150MB
hyperledger/fabric-peer      1.4.0    304fac59b501    9 months ago    157MB
hyperledger/fabric-peer      latest   304fac59b501    9 months ago    157MB

--------------------------------------------------------------------------------
bootstrap : Installing hyperledger/fabric-samples repo
--------------------------------------------------------------------------------
===> [install_03_bootstrap.sh (getSamples)] : Cloning hyperledger/fabric-samples
repo and checkout v1.4.0
running from /home/ubuntu

Note: checking out 'v1.4.0'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b <new-branch-name>

HEAD is now at bb39b6e... [FAB-13570] Align fabric-samples with 1.4.0 release
--------------------------------------------------------------------------------

----
<<bootstrap_install, [back]>>


=== Go libraries peer/chaincode install output log

[[appendix:fabric-go-lib]]
[source, bash]
----
~/hyperledger_ws/install$ ./04_setup_go_libs_for_peers_chaincodes.sh
--------------------------------------------------------------------
Sets up GO libraries for fabric-peer and chaincode
--------------------------------------------------------------------
USER: ubuntu whoami: ubuntu id -un: ubuntu FABRIC_USER: ubuntu  HOME: /home/ubuntu  LOGNAME: ubuntu
--------------------------------------------------------------------
Done.
--------------------------------------------------------------------
----
<<go_lib_install, [back]>>



=== CA-Root install output log

[[appendix:fabric-ca-root]]
[source, bash]
----
./05_install_ca_server.sh
-----------------------------------------------------------------------------------------
Installing CA-server...
-----------------------------------------------------------------------------------------
USER: ubuntu whoami: ubuntu id -un: ubuntu FABRIC_USER: ubuntu  HOME: /home/ubuntu  LOGNAME: ubuntu
This system has a bash shell
-----------------------------------------------------------------------------------------
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following additional packages will be installed:
  autotools-dev binutils cpp cpp-5 gcc gcc-5 gcc-5-base libasan2 libatomic1 libc-dev-bin libc6 libc6-dev libcc1-0 libcilkrts5 libgcc-5-dev libgomp1 libisl15 libitm1 liblsan0 libmpc3 libmpx0 libquadmath0 libstdc++6 libtsan0 libubsan0
  linux-libc-dev manpages-dev
The following NEW packages will be installed:
  autotools-dev binutils cpp cpp-5 gcc gcc-5 libasan2 libatomic1 libc-dev-bin libc6-dev libcc1-0 libcilkrts5 libgcc-5-dev libgomp1 libisl15 libitm1 liblsan0 libltdl-dev libmpc3 libmpx0 libquadmath0 libtool libtsan0 libubsan0
  linux-libc-dev manpages-dev

3 upgraded, 26 newly installed, 0 to remove and 203 not upgraded.
Need to get 30.7 MB of archives.
....
Fetched 30.7 MB in 5s (5567 kB/s)

Preconfiguring packages ...
Unpacking ...
Processing ...
Processing ...
...
...
(many packages)
...
...
-----------------------------------------------------------------------------------------
[install_05_ca_server.sh] USER: ubuntu whoami: ubuntu id -un: ubuntu FABRIC_USER: ubuntu  HOME: /home/ubuntu  LOGNAME: ubuntu
-----------------------------------------------------------------------------------------
CA-server Done.
-----------------------------------------------------------------------------------------

----
<<ca_root_install, [back]>>
